"""Script to test some snippets"""

import time
import csv
from datetime import datetime, timedelta

CONSUMO_JSON = '{"fechaPeriodo":"01-03-202400:00:00","periodoMuestra":"Viernes 1 de marzo de 2024","y":{"vars":["Yo",""],"smps":[],"desc":["Consumo"],"data":[[{"valor":"1159.00","tipo":"null","excluido":false},{"valor":"1124.00","tipo":"null","excluido":false},{"valor":"1190.00","tipo":"null","excluido":false},{"valor":"1260.00","tipo":"null","excluido":false},{"valor":"1241.00","tipo":"null","excluido":false},{"valor":"1235.00","tipo":"null","excluido":false},{"valor":"1384.00","tipo":"null","excluido":false},{"valor":"1406.00","tipo":"null","excluido":false},{"valor":"1491.00","tipo":"null","excluido":false},{"valor":"1501.00","tipo":"null","excluido":false},{"valor":"1367.00","tipo":"null","excluido":false},{"valor":"1306.00","tipo":"null","excluido":false},{"valor":"1189.00","tipo":"null","excluido":false},{"valor":"1153.00","tipo":"null","excluido":false},{"valor":"1086.00","tipo":"null","excluido":false},{"valor":"980.00","tipo":"null","excluido":false},{"valor":"881.00","tipo":"null","excluido":false},{"valor":"969.00","tipo":"null","excluido":false},{"valor":"806.00","tipo":"null","excluido":false},{"valor":"1392.00","tipo":"null","excluido":false},{"valor":"2804.00","tipo":"null","excluido":false},{"valor":"1303.00","tipo":"null","excluido":false},{"valor":"1253.00","tipo":"null","excluido":false},{"valor":"1208.00","tipo":"null","excluido":false},{"valor":"1110.00","tipo":"null","excluido":false},{"valor":"999.00","tipo":"null","excluido":false},{"valor":"1002.00","tipo":"null","excluido":false},{"valor":"2154.00","tipo":"null","excluido":false},{"valor":"2192.00","tipo":"null","excluido":false},{"valor":"1265.00","tipo":"null","excluido":false},{"valor":"1238.00","tipo":"null","excluido":false},{"valor":"1144.00","tipo":"null","excluido":false},{"valor":"1261.00","tipo":"null","excluido":false},{"valor":"1361.00","tipo":"null","excluido":false},{"valor":"1335.00","tipo":"null","excluido":false},{"valor":"1384.00","tipo":"null","excluido":false},{"valor":"1314.00","tipo":"null","excluido":false},{"valor":"1402.00","tipo":"null","excluido":false},{"valor":"1375.00","tipo":"null","excluido":false},{"valor":"1313.00","tipo":"null","excluido":false},{"valor":"1268.00","tipo":"null","excluido":false},{"valor":"1323.00","tipo":"null","excluido":false},{"valor":"1329.00","tipo":"null","excluido":false},{"valor":"2521.00","tipo":"null","excluido":false},{"valor":"1408.00","tipo":"null","excluido":false},{"valor":"1308.00","tipo":"null","excluido":false},{"valor":"1429.00","tipo":"null","excluido":false},{"valor":"1408.00","tipo":"null","excluido":false},{"valor":"1357.00","tipo":"null","excluido":false},{"valor":"1257.00","tipo":"null","excluido":false},{"valor":"1259.00","tipo":"null","excluido":false},{"valor":"1248.00","tipo":"null","excluido":false},{"valor":"1215.00","tipo":"null","excluido":false},{"valor":"1217.00","tipo":"null","excluido":false},{"valor":"1219.00","tipo":"null","excluido":false},{"valor":"1228.00","tipo":"null","excluido":false},{"valor":"1466.00","tipo":"null","excluido":false},{"valor":"1619.00","tipo":"null","excluido":false},{"valor":"2272.00","tipo":"null","excluido":false},{"valor":"1373.00","tipo":"null","excluido":false},{"valor":"2601.00","tipo":"null","excluido":false},{"valor":"1512.00","tipo":"null","excluido":false},{"valor":"1427.00","tipo":"null","excluido":false},{"valor":"1307.00","tipo":"null","excluido":false},{"valor":"1304.00","tipo":"null","excluido":false},{"valor":"1329.00","tipo":"null","excluido":false},{"valor":"1252.00","tipo":"null","excluido":false},{"valor":"1286.00","tipo":"null","excluido":false},{"valor":"1261.00","tipo":"null","excluido":false},{"valor":"1400.00","tipo":"null","excluido":false},{"valor":"1396.00","tipo":"null","excluido":false},{"valor":"1289.00","tipo":"null","excluido":false},{"valor":"1193.00","tipo":"null","excluido":false},{"valor":"1162.00","tipo":"null","excluido":false},{"valor":"1147.00","tipo":"null","excluido":false},{"valor":"1114.00","tipo":"null","excluido":false},{"valor":"1100.00","tipo":"null","excluido":false},{"valor":"1108.00","tipo":"null","excluido":false},{"valor":"1273.00","tipo":"null","excluido":false},{"valor":"1148.00","tipo":"null","excluido":false},{"valor":"1289.00","tipo":"null","excluido":false},{"valor":"2505.00","tipo":"null","excluido":false},{"valor":"1991.00","tipo":"null","excluido":false},{"valor":"1750.00","tipo":"null","excluido":false},{"valor":"1304.00","tipo":"null","excluido":false},{"valor":"1233.00","tipo":"null","excluido":false},{"valor":"1124.00","tipo":"null","excluido":false},{"valor":"1083.00","tipo":"null","excluido":false},{"valor":"954.00","tipo":"null","excluido":false},{"valor":"1023.00","tipo":"null","excluido":false},{"valor":"1184.00","tipo":"null","excluido":false},{"valor":"1084.00","tipo":"null","excluido":false},{"valor":"953.00","tipo":"null","excluido":false},{"valor":"1014.00","tipo":"null","excluido":false},{"valor":"552.00","tipo":"null","excluido":false},{"valor":"526.00","tipo":"null","excluido":false},{"valor":"585.00","tipo":"null","excluido":false},{"valor":"499.00","tipo":"null","excluido":false},{"valor":"940.00","tipo":"null","excluido":false},{"valor":"1281.00","tipo":"null","excluido":false},{"valor":"1284.00","tipo":"null","excluido":false},{"valor":"1180.00","tipo":"null","excluido":false},{"valor":"1317.00","tipo":"null","excluido":false},{"valor":"1238.00","tipo":"null","excluido":false},{"valor":"2585.00","tipo":"null","excluido":false},{"valor":"1730.00","tipo":"null","excluido":false},{"valor":"1474.00","tipo":"null","excluido":false},{"valor":"1373.00","tipo":"null","excluido":false},{"valor":"1202.00","tipo":"null","excluido":false},{"valor":"1152.00","tipo":"null","excluido":false},{"valor":"1014.00","tipo":"null","excluido":false},{"valor":"965.00","tipo":"null","excluido":false},{"valor":"861.00","tipo":"null","excluido":false},{"valor":"860.00","tipo":"null","excluido":false},{"valor":"997.00","tipo":"null","excluido":false},{"valor":"784.00","tipo":"null","excluido":false},{"valor":"735.00","tipo":"null","excluido":false},{"valor":"654.00","tipo":"null","excluido":false},{"valor":"551.00","tipo":"null","excluido":false},{"valor":"696.00","tipo":"null","excluido":false},{"valor":"547.00","tipo":"null","excluido":false},{"valor":"1465.00","tipo":"null","excluido":false},{"valor":"1400.00","tipo":"null","excluido":false},{"valor":"1275.00","tipo":"null","excluido":false},{"valor":"1218.00","tipo":"null","excluido":false},{"valor":"1191.00","tipo":"null","excluido":false},{"valor":"1359.00","tipo":"null","excluido":false},{"valor":"2681.00","tipo":"null","excluido":false},{"valor":"1632.00","tipo":"null","excluido":false},{"valor":"1541.00","tipo":"null","excluido":false},{"valor":"1401.00","tipo":"null","excluido":false},{"valor":"1278.00","tipo":"null","excluido":false},{"valor":"1441.00","tipo":"null","excluido":false},{"valor":"1128.00","tipo":"null","excluido":false},{"valor":"1072.00","tipo":"null","excluido":false},{"valor":"972.00","tipo":"null","excluido":false},{"valor":"862.00","tipo":"null","excluido":false},{"valor":"856.00","tipo":"null","excluido":false},{"valor":"1028.00","tipo":"null","excluido":false},{"valor":"790.00","tipo":"null","excluido":false},{"valor":"767.00","tipo":"null","excluido":false},{"valor":"509.00","tipo":"null","excluido":false},{"valor":"605.00","tipo":"null","excluido":false},{"valor":"740.00","tipo":"null","excluido":false},{"valor":"615.00","tipo":"null","excluido":false},{"valor":"1358.00","tipo":"null","excluido":false},{"valor":"1102.00","tipo":"null","excluido":false},{"valor":"1043.00","tipo":"null","excluido":false},{"valor":"1180.00","tipo":"null","excluido":false},{"valor":"1190.00","tipo":"null","excluido":false},{"valor":"2595.00","tipo":"null","excluido":false},{"valor":"1449.00","tipo":"null","excluido":false},{"valor":"1308.00","tipo":"null","excluido":false},{"valor":"1214.00","tipo":"null","excluido":false},{"valor":"1257.00","tipo":"null","excluido":false},{"valor":"1141.00","tipo":"null","excluido":false},{"valor":"1181.00","tipo":"null","excluido":false},{"valor":"1232.00","tipo":"null","excluido":false},{"valor":"1126.00","tipo":"null","excluido":false},{"valor":"1118.00","tipo":"null","excluido":false},{"valor":"1136.00","tipo":"null","excluido":false},{"valor":"1264.00","tipo":"null","excluido":false},{"valor":"1832.00","tipo":"null","excluido":false},{"valor":"1371.00","tipo":"null","excluido":false},{"valor":"2208.00","tipo":"null","excluido":false},{"valor":"1636.00","tipo":"null","excluido":false},{"valor":"1140.00","tipo":"null","excluido":false},{"valor":"1202.00","tipo":"null","excluido":false},{"valor":"1075.00","tipo":"null","excluido":false},{"valor":"1032.00","tipo":"null","excluido":false},{"valor":"1212.00","tipo":"null","excluido":false},{"valor":"1154.00","tipo":"null","excluido":false},{"valor":"1124.00","tipo":"null","excluido":false},{"valor":"1127.00","tipo":"null","excluido":false},{"valor":"1283.00","tipo":"null","excluido":false},{"valor":"1228.00","tipo":"null","excluido":false},{"valor":"1545.00","tipo":"null","excluido":false},{"valor":"1557.00","tipo":"null","excluido":false},{"valor":"1719.00","tipo":"null","excluido":false},{"valor":"1972.00","tipo":"null","excluido":false},{"valor":"1739.00","tipo":"null","excluido":false},{"valor":"1545.00","tipo":"null","excluido":false},{"valor":"1447.00","tipo":"null","excluido":false},{"valor":"1396.00","tipo":"null","excluido":false},{"valor":"1248.00","tipo":"null","excluido":false},{"valor":"1364.00","tipo":"null","excluido":false},{"valor":"1310.00","tipo":"null","excluido":false},{"valor":"1379.00","tipo":"null","excluido":false},{"valor":"1469.00","tipo":"null","excluido":false},{"valor":"2605.00","tipo":"null","excluido":false},{"valor":"1766.00","tipo":"null","excluido":false},{"valor":"1481.00","tipo":"null","excluido":false},{"valor":"1401.00","tipo":"null","excluido":false},{"valor":"1219.00","tipo":"null","excluido":false},{"valor":"1161.00","tipo":"null","excluido":false},{"valor":"1091.00","tipo":"null","excluido":false},{"valor":"1016.00","tipo":"null","excluido":false},{"valor":"1021.00","tipo":"null","excluido":false},{"valor":"1043.00","tipo":"null","excluido":false},{"valor":"1052.00","tipo":"null","excluido":false},{"valor":"1274.00","tipo":"null","excluido":false},{"valor":"1269.00","tipo":"null","excluido":false},{"valor":"1990.00","tipo":"null","excluido":false},{"valor":"2030.00","tipo":"null","excluido":false},{"valor":"1821.00","tipo":"null","excluido":false},{"valor":"1317.00","tipo":"null","excluido":false},{"valor":"1428.00","tipo":"null","excluido":false},{"valor":"1411.00","tipo":"null","excluido":false},{"valor":"1357.00","tipo":"null","excluido":false},{"valor":"1412.00","tipo":"null","excluido":false},{"valor":"1302.00","tipo":"null","excluido":false},{"valor":"1331.00","tipo":"null","excluido":false},{"valor":"1540.00","tipo":"null","excluido":false},{"valor":"1313.00","tipo":"null","excluido":false},{"valor":"1360.00","tipo":"null","excluido":false},{"valor":"1936.00","tipo":"null","excluido":false},{"valor":"1657.00","tipo":"null","excluido":false},{"valor":"1471.00","tipo":"null","excluido":false},{"valor":"1342.00","tipo":"null","excluido":false},{"valor":"1235.00","tipo":"null","excluido":false},{"valor":"1173.00","tipo":"null","excluido":false},{"valor":"1152.00","tipo":"null","excluido":false},{"valor":"1143.00","tipo":"null","excluido":false},{"valor":"1140.00","tipo":"null","excluido":false},{"valor":"1312.00","tipo":"null","excluido":false},{"valor":"1312.00","tipo":"null","excluido":false},{"valor":"1258.00","tipo":"null","excluido":false},{"valor":"1301.00","tipo":"null","excluido":false},{"valor":"2151.00","tipo":"null","excluido":false},{"valor":"1488.00","tipo":"null","excluido":false},{"valor":"1278.00","tipo":"null","excluido":false},{"valor":"1187.00","tipo":"null","excluido":false},{"valor":"1168.00","tipo":"null","excluido":false},{"valor":"1223.00","tipo":"null","excluido":false},{"valor":"2332.00","tipo":"null","excluido":false},{"valor":"1701.00","tipo":"null","excluido":false},{"valor":"1292.00","tipo":"null","excluido":false},{"valor":"1364.00","tipo":"null","excluido":false},{"valor":"1400.00","tipo":"null","excluido":false},{"valor":"1380.00","tipo":"null","excluido":false},{"valor":"1229.00","tipo":"null","excluido":false},{"valor":"1120.00","tipo":"null","excluido":false},{"valor":"1036.00","tipo":"null","excluido":false},{"valor":"1003.00","tipo":"null","excluido":false},{"valor":"1002.00","tipo":"null","excluido":false},{"valor":"1003.00","tipo":"null","excluido":false},{"valor":"1200.00","tipo":"null","excluido":false},{"valor":"1222.00","tipo":"null","excluido":false},{"valor":"1362.00","tipo":"null","excluido":false},{"valor":"1458.00","tipo":"null","excluido":false},{"valor":"1194.00","tipo":"null","excluido":false},{"valor":"1103.00","tipo":"null","excluido":false},{"valor":"1071.00","tipo":"null","excluido":false},{"valor":"857.00","tipo":"null","excluido":false},{"valor":"771.00","tipo":"null","excluido":false},{"valor":"745.00","tipo":"null","excluido":false},{"valor":"657.00","tipo":"null","excluido":false},{"valor":"707.00","tipo":"null","excluido":false},{"valor":"827.00","tipo":"null","excluido":false},{"valor":"1484.00","tipo":"null","excluido":false},{"valor":"1594.00","tipo":"null","excluido":false},{"valor":"522.00","tipo":"null","excluido":false},{"valor":"636.00","tipo":"null","excluido":false},{"valor":"1087.00","tipo":"null","excluido":false},{"valor":"1320.00","tipo":"null","excluido":false},{"valor":"1141.00","tipo":"null","excluido":false},{"valor":"1253.00","tipo":"null","excluido":false},{"valor":"1192.00","tipo":"null","excluido":false},{"valor":"1161.00","tipo":"null","excluido":false},{"valor":"1142.00","tipo":"null","excluido":false},{"valor":"1241.00","tipo":"null","excluido":false},{"valor":"1254.00","tipo":"null","excluido":false},{"valor":"1358.00","tipo":"null","excluido":false},{"valor":"1357.00","tipo":"null","excluido":false},{"valor":"1229.00","tipo":"null","excluido":false},{"valor":"1198.00","tipo":"null","excluido":false},{"valor":"1061.00","tipo":"null","excluido":false},{"valor":"986.00","tipo":"null","excluido":false},{"valor":"828.00","tipo":"null","excluido":false},{"valor":"723.00","tipo":"null","excluido":false},{"valor":"514.00","tipo":"null","excluido":false},{"valor":"272.00","tipo":"null","excluido":false},{"valor":"687.00","tipo":"null","excluido":false},{"valor":"1688.00","tipo":"null","excluido":false},{"valor":"1672.00","tipo":"null","excluido":false},{"valor":"918.00","tipo":"null","excluido":false},{"valor":"868.00","tipo":"null","excluido":false},{"valor":"864.00","tipo":"null","excluido":false},{"valor":"940.00","tipo":"null","excluido":false},{"valor":"802.00","tipo":"null","excluido":false},{"valor":"1356.00","tipo":"null","excluido":false},{"valor":"1130.00","tipo":"null","excluido":false},{"valor":"1045.00","tipo":"null","excluido":false},{"valor":"1012.00","tipo":"null","excluido":false},{"valor":"1235.00","tipo":"null","excluido":false},{"valor":"1274.00","tipo":"null","excluido":false},{"valor":"1310.00","tipo":"null","excluido":false},{"valor":"1203.00","tipo":"null","excluido":false},{"valor":"1229.00","tipo":"null","excluido":false},{"valor":"1017.00","tipo":"null","excluido":false},{"valor":"1056.00","tipo":"null","excluido":false},{"valor":"803.00","tipo":"null","excluido":false},{"valor":"619.00","tipo":"null","excluido":false},{"valor":"729.00","tipo":"null","excluido":false},{"valor":"628.00","tipo":"null","excluido":false},{"valor":"609.00","tipo":"null","excluido":false},{"valor":"670.00","tipo":"null","excluido":false},{"valor":"1836.00","tipo":"null","excluido":false},{"valor":"596.00","tipo":"null","excluido":false},{"valor":"404.00","tipo":"null","excluido":false},{"valor":"424.00","tipo":"null","excluido":false},{"valor":"335.00","tipo":"null","excluido":false},{"valor":"343.00","tipo":"null","excluido":false},{"valor":"815.00","tipo":"null","excluido":false},{"valor":"707.00","tipo":"null","excluido":false},{"valor":"1165.00","tipo":"null","excluido":false},{"valor":"1147.00","tipo":"null","excluido":false},{"valor":"1051.00","tipo":"null","excluido":false},{"valor":"1213.00","tipo":"null","excluido":false},{"valor":"1307.00","tipo":"null","excluido":false},{"valor":"1230.00","tipo":"null","excluido":false},{"valor":"1292.00","tipo":"null","excluido":false},{"valor":"1094.00","tipo":"null","excluido":false},{"valor":"1515.00","tipo":"null","excluido":false},{"valor":"715.00","tipo":"null","excluido":false},{"valor":"656.00","tipo":"null","excluido":false},{"valor":"362.00","tipo":"null","excluido":false},{"valor":"310.00","tipo":"null","excluido":false},{"valor":"226.00","tipo":"null","excluido":false},{"valor":"363.00","tipo":"null","excluido":false},{"valor":"391.00","tipo":"null","excluido":false},{"valor":"1324.00","tipo":"null","excluido":false},{"valor":"1297.00","tipo":"null","excluido":false},{"valor":"1060.00","tipo":"null","excluido":false},{"valor":"1388.00","tipo":"null","excluido":false},{"valor":"1213.00","tipo":"null","excluido":false},{"valor":"1181.00","tipo":"null","excluido":false},{"valor":"1137.00","tipo":"null","excluido":false},{"valor":"1028.00","tipo":"null","excluido":false},{"valor":"915.00","tipo":"null","excluido":false},{"valor":"1012.00","tipo":"null","excluido":false},{"valor":"937.00","tipo":"null","excluido":false},{"valor":"1100.00","tipo":"null","excluido":false},{"valor":"1193.00","tipo":"null","excluido":false},{"valor":"1210.00","tipo":"null","excluido":false},{"valor":"1107.00","tipo":"null","excluido":false},null,{"valor":"1964.00","tipo":"null","excluido":false},{"valor":"773.00","tipo":"null","excluido":false},{"valor":"696.00","tipo":"null","excluido":false},{"valor":"475.00","tipo":"null","excluido":false},{"valor":"305.00","tipo":"null","excluido":false},{"valor":"278.00","tipo":"null","excluido":false},{"valor":"434.00","tipo":"null","excluido":false},{"valor":"808.00","tipo":"null","excluido":false},{"valor":"1703.00","tipo":"null","excluido":false},{"valor":"1226.00","tipo":"null","excluido":false},{"valor":"648.00","tipo":"null","excluido":false},{"valor":"890.00","tipo":"null","excluido":false},{"valor":"811.00","tipo":"null","excluido":false},{"valor":"660.00","tipo":"null","excluido":false},{"valor":"301.00","tipo":"null","excluido":false},{"valor":"766.00","tipo":"null","excluido":false},{"valor":"1074.00","tipo":"null","excluido":false},{"valor":"959.00","tipo":"null","excluido":false},{"valor":"931.00","tipo":"null","excluido":false},{"valor":"901.00","tipo":"null","excluido":false},{"valor":"1085.00","tipo":"null","excluido":false},{"valor":"1157.00","tipo":"null","excluido":false},{"valor":"1128.00","tipo":"null","excluido":false},{"valor":"1037.00","tipo":"null","excluido":false},{"valor":"975.00","tipo":"null","excluido":false},{"valor":"938.00","tipo":"null","excluido":false},{"valor":"1257.00","tipo":"null","excluido":false},{"valor":"758.00","tipo":"null","excluido":false},{"valor":"365.00","tipo":"null","excluido":false},{"valor":"320.00","tipo":"null","excluido":false},{"valor":"497.00","tipo":"null","excluido":false},{"valor":"294.00","tipo":"null","excluido":false},{"valor":"307.00","tipo":"null","excluido":false},{"valor":"1491.00","tipo":"null","excluido":false},{"valor":"357.00","tipo":"null","excluido":false},{"valor":"618.00","tipo":"null","excluido":false},{"valor":"892.00","tipo":"null","excluido":false},{"valor":"454.00","tipo":"null","excluido":false},{"valor":"1647.00","tipo":"null","excluido":false},{"valor":"1084.00","tipo":"null","excluido":false},{"valor":"2155.00","tipo":"null","excluido":false},{"valor":"2197.00","tipo":"null","excluido":false},{"valor":"1345.00","tipo":"null","excluido":false},{"valor":"1258.00","tipo":"null","excluido":false},null,{"valor":"1211.00","tipo":"null","excluido":false},{"valor":"992.00","tipo":"null","excluido":false},{"valor":"1072.00","tipo":"null","excluido":false},{"valor":"1311.00","tipo":"null","excluido":false},{"valor":"974.00","tipo":"null","excluido":false},{"valor":"528.00","tipo":"null","excluido":false},{"valor":"406.00","tipo":"null","excluido":false},{"valor":"403.00","tipo":"null","excluido":false},{"valor":"294.00","tipo":"null","excluido":false},{"valor":"413.00","tipo":"null","excluido":false},{"valor":"193.00","tipo":"null","excluido":false},{"valor":"264.00","tipo":"null","excluido":false},{"valor":"966.00","tipo":"null","excluido":false},{"valor":"1209.00","tipo":"null","excluido":false},{"valor":"536.00","tipo":"null","excluido":false},{"valor":"726.00","tipo":"null","excluido":false},{"valor":"610.00","tipo":"null","excluido":false},{"valor":"595.00","tipo":"null","excluido":false},{"valor":"582.00","tipo":"null","excluido":false},{"valor":"600.00","tipo":"null","excluido":false},{"valor":"592.00","tipo":"null","excluido":false},{"valor":"552.00","tipo":"null","excluido":false},{"valor":"1068.00","tipo":"null","excluido":false},{"valor":"1279.00","tipo":"null","excluido":false},{"valor":"1337.00","tipo":"null","excluido":false},{"valor":"1231.00","tipo":"null","excluido":false},{"valor":"1112.00","tipo":"null","excluido":false},{"valor":"697.00","tipo":"null","excluido":false},{"valor":"386.00","tipo":"null","excluido":false},{"valor":"309.00","tipo":"null","excluido":false},{"valor":"221.00","tipo":"null","excluido":false},{"valor":"210.00","tipo":"null","excluido":false},{"valor":"251.00","tipo":"null","excluido":false},{"valor":"168.00","tipo":"null","excluido":false},{"valor":"387.00","tipo":"null","excluido":false},{"valor":"1176.00","tipo":"null","excluido":false},{"valor":"988.00","tipo":"null","excluido":false},{"valor":"372.00","tipo":"null","excluido":false},{"valor":"924.00","tipo":"null","excluido":false},{"valor":"742.00","tipo":"null","excluido":false},{"valor":"481.00","tipo":"null","excluido":false},{"valor":"631.00","tipo":"null","excluido":false},{"valor":"560.00","tipo":"null","excluido":false},{"valor":"164.00","tipo":"null","excluido":false},{"valor":"268.00","tipo":"null","excluido":false},{"valor":"163.00","tipo":"null","excluido":false},{"valor":"1291.00","tipo":"null","excluido":false},{"valor":"1179.00","tipo":"null","excluido":false},{"valor":"1299.00","tipo":"null","excluido":false},{"valor":"1295.00","tipo":"null","excluido":false},{"valor":"1072.00","tipo":"null","excluido":false},{"valor":"656.00","tipo":"null","excluido":false},{"valor":"373.00","tipo":"null","excluido":false},{"valor":"327.00","tipo":"null","excluido":false},{"valor":"287.00","tipo":"null","excluido":false},{"valor":"270.00","tipo":"null","excluido":false},{"valor":"326.00","tipo":"null","excluido":false},{"valor":"325.00","tipo":"null","excluido":false},{"valor":"235.00","tipo":"null","excluido":false},{"valor":"343.00","tipo":"null","excluido":false},{"valor":"1988.00","tipo":"null","excluido":false},{"valor":"379.00","tipo":"null","excluido":false},{"valor":"371.00","tipo":"null","excluido":false},{"valor":"449.00","tipo":"null","excluido":false},{"valor":"291.00","tipo":"null","excluido":false},{"valor":"191.00","tipo":"null","excluido":false},{"valor":"175.00","tipo":"null","excluido":false},{"valor":"253.00","tipo":"null","excluido":false},{"valor":"156.00","tipo":"null","excluido":false},{"valor":"175.00","tipo":"null","excluido":false},{"valor":"421.00","tipo":"null","excluido":false},{"valor":"928.00","tipo":"null","excluido":false},{"valor":"1243.00","tipo":"null","excluido":false},{"valor":"1424.00","tipo":"null","excluido":false},{"valor":"1124.00","tipo":"null","excluido":false},{"valor":"746.00","tipo":"null","excluido":false},{"valor":"288.00","tipo":"null","excluido":false},{"valor":"344.00","tipo":"null","excluido":false},{"valor":"205.00","tipo":"null","excluido":false},{"valor":"211.00","tipo":"null","excluido":false},{"valor":"147.00","tipo":"null","excluido":false},{"valor":"168.00","tipo":"null","excluido":false},{"valor":"380.00","tipo":"null","excluido":false},{"valor":"412.00","tipo":"null","excluido":false},{"valor":"725.00","tipo":"null","excluido":false},{"valor":"1397.00","tipo":"null","excluido":false},{"valor":"365.00","tipo":"null","excluido":false},{"valor":"445.00","tipo":"null","excluido":false},{"valor":"480.00","tipo":"null","excluido":false},{"valor":"198.00","tipo":"null","excluido":false},{"valor":"198.00","tipo":"null","excluido":false},{"valor":"231.00","tipo":"null","excluido":false},{"valor":"160.00","tipo":"null","excluido":false},{"valor":"176.00","tipo":"null","excluido":false},{"valor":"642.00","tipo":"null","excluido":false},{"valor":"931.00","tipo":"null","excluido":false},{"valor":"1104.00","tipo":"null","excluido":false},{"valor":"1447.00","tipo":"null","excluido":false},{"valor":"1193.00","tipo":"null","excluido":false},{"valor":"853.00","tipo":"null","excluido":false},{"valor":"346.00","tipo":"null","excluido":false},{"valor":"346.00","tipo":"null","excluido":false},{"valor":"335.00","tipo":"null","excluido":false},{"valor":"266.00","tipo":"null","excluido":false},{"valor":"205.00","tipo":"null","excluido":false},{"valor":"181.00","tipo":"null","excluido":false},{"valor":"206.00","tipo":"null","excluido":false},{"valor":"366.00","tipo":"null","excluido":false},{"valor":"322.00","tipo":"null","excluido":false},{"valor":"369.00","tipo":"null","excluido":false},{"valor":"288.00","tipo":"null","excluido":false},{"valor":"322.00","tipo":"null","excluido":false},{"valor":"242.00","tipo":"null","excluido":false},{"valor":"287.00","tipo":"null","excluido":false},{"valor":"175.00","tipo":"null","excluido":false},{"valor":"1681.00","tipo":"null","excluido":false},{"valor":"141.00","tipo":"null","excluido":false},{"valor":"160.00","tipo":"null","excluido":false},{"valor":"290.00","tipo":"null","excluido":false},{"valor":"202.00","tipo":"null","excluido":false},{"valor":"602.00","tipo":"null","excluido":false},{"valor":"704.00","tipo":"null","excluido":false},{"valor":"726.00","tipo":"null","excluido":false},{"valor":"461.00","tipo":"null","excluido":false},{"valor":"458.00","tipo":"null","excluido":false},{"valor":"470.00","tipo":"null","excluido":false},{"valor":"339.00","tipo":"null","excluido":false},{"valor":"276.00","tipo":"null","excluido":false},{"valor":"259.00","tipo":"null","excluido":false},{"valor":"367.00","tipo":"null","excluido":false},{"valor":"282.00","tipo":"null","excluido":false},{"valor":"949.00","tipo":"null","excluido":false},{"valor":"560.00","tipo":"null","excluido":false},{"valor":"538.00","tipo":"null","excluido":false},{"valor":"1893.00","tipo":"null","excluido":false},{"valor":"367.00","tipo":"null","excluido":false},{"valor":"210.00","tipo":"null","excluido":false},{"valor":"204.00","tipo":"null","excluido":false},{"valor":"251.00","tipo":"null","excluido":false},{"valor":"149.00","tipo":"null","excluido":false},{"valor":"165.00","tipo":"null","excluido":false},{"valor":"243.00","tipo":"null","excluido":false},{"valor":"1006.00","tipo":"null","excluido":false},{"valor":"1099.00","tipo":"null","excluido":false},{"valor":"1264.00","tipo":"null","excluido":false},{"valor":"1182.00","tipo":"null","excluido":false},{"valor":"643.00","tipo":"null","excluido":false},{"valor":"271.00","tipo":"null","excluido":false},{"valor":"152.00","tipo":"null","excluido":false},{"valor":"160.00","tipo":"null","excluido":false},{"valor":"162.00","tipo":"null","excluido":false},{"valor":"148.00","tipo":"null","excluido":false},{"valor":"173.00","tipo":"null","excluido":false},{"valor":"185.00","tipo":"null","excluido":false},{"valor":"258.00","tipo":"null","excluido":false},{"valor":"170.00","tipo":"null","excluido":false},{"valor":"163.00","tipo":"null","excluido":false},{"valor":"161.00","tipo":"null","excluido":false},{"valor":"166.00","tipo":"null","excluido":false},{"valor":"179.00","tipo":"null","excluido":false},{"valor":"248.00","tipo":"null","excluido":false},{"valor":"155.00","tipo":"null","excluido":false},{"valor":"176.00","tipo":"null","excluido":false},{"valor":"272.00","tipo":"null","excluido":false},{"valor":"169.00","tipo":"null","excluido":false},{"valor":"192.00","tipo":"null","excluido":false},{"valor":"275.00","tipo":"null","excluido":false},{"valor":"185.00","tipo":"null","excluido":false},{"valor":"266.00","tipo":"null","excluido":false},{"valor":"176.00","tipo":"null","excluido":false},{"valor":"172.00","tipo":"null","excluido":false},{"valor":"176.00","tipo":"null","excluido":false},{"valor":"247.00","tipo":"null","excluido":false},{"valor":"154.00","tipo":"null","excluido":false},{"valor":"155.00","tipo":"null","excluido":false},{"valor":"169.00","tipo":"null","excluido":false},{"valor":"254.00","tipo":"null","excluido":false},{"valor":"176.00","tipo":"null","excluido":false},{"valor":"164.00","tipo":"null","excluido":false},{"valor":"1193.00","tipo":"null","excluido":false},{"valor":"486.00","tipo":"null","excluido":false},{"valor":"176.00","tipo":"null","excluido":false},{"valor":"176.00","tipo":"null","excluido":false},{"valor":"240.00","tipo":"null","excluido":false},{"valor":"175.00","tipo":"null","excluido":false},{"valor":"313.00","tipo":"null","excluido":false},{"valor":"301.00","tipo":"null","excluido":false},{"valor":"298.00","tipo":"null","excluido":false},{"valor":"215.00","tipo":"null","excluido":false},{"valor":"257.00","tipo":"null","excluido":false},{"valor":"192.00","tipo":"null","excluido":false},{"valor":"196.00","tipo":"null","excluido":false},{"valor":"286.00","tipo":"null","excluido":false},{"valor":"187.00","tipo":"null","excluido":false},{"valor":"197.00","tipo":"null","excluido":false},{"valor":"240.00","tipo":"null","excluido":false},{"valor":"177.00","tipo":"null","excluido":false},{"valor":"249.00","tipo":"null","excluido":false},{"valor":"174.00","tipo":"null","excluido":false},{"valor":"266.00","tipo":"null","excluido":false},{"valor":"217.00","tipo":"null","excluido":false},{"valor":"432.00","tipo":"null","excluido":false},{"valor":"402.00","tipo":"null","excluido":false},{"valor":"557.00","tipo":"null","excluido":false},{"valor":"529.00","tipo":"null","excluido":false},{"valor":"573.00","tipo":"null","excluido":false},{"valor":"559.00","tipo":"null","excluido":false},{"valor":"554.00","tipo":"null","excluido":false},{"valor":"541.00","tipo":"null","excluido":false},{"valor":"588.00","tipo":"null","excluido":false},{"valor":"626.00","tipo":"null","excluido":false},{"valor":"670.00","tipo":"null","excluido":false},{"valor":"680.00","tipo":"null","excluido":false},{"valor":"699.00","tipo":"null","excluido":false},{"valor":"692.00","tipo":"null","excluido":false},{"valor":"731.00","tipo":"null","excluido":false},{"valor":"763.00","tipo":"null","excluido":false},{"valor":"687.00","tipo":"null","excluido":false},{"valor":"662.00","tipo":"null","excluido":false},{"valor":"574.00","tipo":"null","excluido":false},{"valor":"622.00","tipo":"null","excluido":false},{"valor":"2026.00","tipo":"null","excluido":false},{"valor":"603.00","tipo":"null","excluido":false},{"valor":"612.00","tipo":"null","excluido":false},{"valor":"562.00","tipo":"null","excluido":false},{"valor":"627.00","tipo":"null","excluido":false},{"valor":"563.00","tipo":"null","excluido":false},{"valor":"688.00","tipo":"null","excluido":false},{"valor":"742.00","tipo":"null","excluido":false},{"valor":"803.00","tipo":"null","excluido":false},{"valor":"725.00","tipo":"null","excluido":false},{"valor":"713.00","tipo":"null","excluido":false},{"valor":"748.00","tipo":"null","excluido":false},{"valor":"802.00","tipo":"null","excluido":false},{"valor":"719.00","tipo":"null","excluido":false},{"valor":"711.00","tipo":"null","excluido":false},{"valor":"709.00","tipo":"null","excluido":false},{"valor":"688.00","tipo":"null","excluido":false},{"valor":"741.00","tipo":"null","excluido":false},{"valor":"733.00","tipo":"null","excluido":false},{"valor":"680.00","tipo":"null","excluido":false},{"valor":"636.00","tipo":"null","excluido":false},{"valor":"580.00","tipo":"null","excluido":false},{"valor":"549.00","tipo":"null","excluido":false},{"valor":"585.00","tipo":"null","excluido":false},{"valor":"671.00","tipo":"null","excluido":false},{"valor":"605.00","tipo":"null","excluido":false},{"valor":"564.00","tipo":"null","excluido":false},{"valor":"557.00","tipo":"null","excluido":false},{"valor":"561.00","tipo":"null","excluido":false},{"valor":"584.00","tipo":"null","excluido":false},{"valor":"561.00","tipo":"null","excluido":false},{"valor":"565.00","tipo":"null","excluido":false},{"valor":"552.00","tipo":"null","excluido":false},{"valor":"559.00","tipo":"null","excluido":false},{"valor":"596.00","tipo":"null","excluido":false},{"valor":"597.00","tipo":"null","excluido":false},{"valor":"598.00","tipo":"null","excluido":false},{"valor":"1220.00","tipo":"null","excluido":false},{"valor":"1263.00","tipo":"null","excluido":false},{"valor":"672.00","tipo":"null","excluido":false},{"valor":"698.00","tipo":"null","excluido":false},{"valor":"690.00","tipo":"null","excluido":false},{"valor":"681.00","tipo":"null","excluido":false},{"valor":"676.00","tipo":"null","excluido":false},{"valor":"575.00","tipo":"null","excluido":false},{"valor":"581.00","tipo":"null","excluido":false},{"valor":"538.00","tipo":"null","excluido":false},{"valor":"538.00","tipo":"null","excluido":false},{"valor":"514.00","tipo":"null","excluido":false},{"valor":"522.00","tipo":"null","excluido":false},{"valor":"511.00","tipo":"null","excluido":false},{"valor":"482.00","tipo":"null","excluido":false},{"valor":"477.00","tipo":"null","excluido":false},{"valor":"497.00","tipo":"null","excluido":false},{"valor":"572.00","tipo":"null","excluido":false},{"valor":"534.00","tipo":"null","excluido":false},{"valor":"583.00","tipo":"null","excluido":false},{"valor":"541.00","tipo":"null","excluido":false},{"valor":"565.00","tipo":"null","excluido":false},{"valor":"572.00","tipo":"null","excluido":false},{"valor":"565.00","tipo":"null","excluido":false},{"valor":"554.00","tipo":"null","excluido":false},{"valor":"585.00","tipo":"null","excluido":false},{"valor":"597.00","tipo":"null","excluido":false},{"valor":"679.00","tipo":"null","excluido":false},{"valor":"679.00","tipo":"null","excluido":false},{"valor":"676.00","tipo":"null","excluido":false},{"valor":"924.00","tipo":"null","excluido":false},{"valor":"903.00","tipo":"null","excluido":false},{"valor":"1565.00","tipo":"null","excluido":false},{"valor":"1534.00","tipo":"null","excluido":false},{"valor":"1343.00","tipo":"null","excluido":false},{"valor":"715.00","tipo":"null","excluido":false},{"valor":"735.00","tipo":"null","excluido":false},{"valor":"766.00","tipo":"null","excluido":false},{"valor":"680.00","tipo":"null","excluido":false},{"valor":"1495.00","tipo":"null","excluido":false},{"valor":"1070.00","tipo":"null","excluido":false},{"valor":"702.00","tipo":"null","excluido":false},{"valor":"705.00","tipo":"null","excluido":false},{"valor":"811.00","tipo":"null","excluido":false},{"valor":"876.00","tipo":"null","excluido":false},{"valor":"889.00","tipo":"null","excluido":false},{"valor":"876.00","tipo":"null","excluido":false},{"valor":"892.00","tipo":"null","excluido":false},{"valor":"900.00","tipo":"null","excluido":false},{"valor":"794.00","tipo":"null","excluido":false},{"valor":"1812.00","tipo":"null","excluido":false},{"valor":"1468.00","tipo":"null","excluido":false},{"valor":"1241.00","tipo":"null","excluido":false},{"valor":"827.00","tipo":"null","excluido":false},{"valor":"918.00","tipo":"null","excluido":false},{"valor":"891.00","tipo":"null","excluido":false},{"valor":"746.00","tipo":"null","excluido":false},{"valor":"626.00","tipo":"null","excluido":false},{"valor":"605.00","tipo":"null","excluido":false},{"valor":"626.00","tipo":"null","excluido":false},{"valor":"617.00","tipo":"null","excluido":false},{"valor":"615.00","tipo":"null","excluido":false},{"valor":"613.00","tipo":"null","excluido":false},{"valor":"699.00","tipo":"null","excluido":false},{"valor":"713.00","tipo":"null","excluido":false},{"valor":"719.00","tipo":"null","excluido":false},{"valor":"1005.00","tipo":"null","excluido":false},{"valor":"829.00","tipo":"null","excluido":false},{"valor":"753.00","tipo":"null","excluido":false},{"valor":"816.00","tipo":"null","excluido":false},{"valor":"764.00","tipo":"null","excluido":false},{"valor":"1830.00","tipo":"null","excluido":false},{"valor":"1499.00","tipo":"null","excluido":false},{"valor":"1323.00","tipo":"null","excluido":false},{"valor":"822.00","tipo":"null","excluido":false},{"valor":"772.00","tipo":"null","excluido":false},{"valor":"1309.00","tipo":"null","excluido":false},{"valor":"1890.00","tipo":"null","excluido":false},{"valor":"869.00","tipo":"null","excluido":false},{"valor":"747.00","tipo":"null","excluido":false},{"valor":"724.00","tipo":"null","excluido":false},{"valor":"757.00","tipo":"null","excluido":false},{"valor":"729.00","tipo":"null","excluido":false},{"valor":"660.00","tipo":"null","excluido":false},{"valor":"666.00","tipo":"null","excluido":false},{"valor":"591.00","tipo":"null","excluido":false},{"valor":"686.00","tipo":"null","excluido":false},{"valor":"901.00","tipo":"null","excluido":false},{"valor":"825.00","tipo":"null","excluido":false},{"valor":"1814.00","tipo":"null","excluido":false},{"valor":"1471.00","tipo":"null","excluido":false},{"valor":"1217.00","tipo":"null","excluido":false},{"valor":"832.00","tipo":"null","excluido":false}]],"dataExcluido":[],"unidadesConsumo":"Wh"},"acumulado":"673974.00","acumuladoCO2":"162427.73","consumoMedio":"0","mostrarBotonComparar":"","consumoMaximo":"2804.00","posicionConsumoMaximo":"20","periodoConsumoMaximo":"Periodo Punta","mediaDiariaConsumo":"22465.8"}'
CSV_DATA = [["watts", "date", "timestamp"]]
CONSUMO_DAY = [1001.0, 1002.0, 1003.0, 1004.0, 1005.0, 1006.0, 1007.0, 1008.0, 1009.0, 1010.0, 1011.0, 1012.0, 1013.0, 1014.0, 1015.0, 1016.0, 1017.0, 1018.0, 1019.0, 1020.0, 1021.0, 1022.0, 1023.0, 1024.0]
CONSUMO = []
MONTH = 2
YEAR = 2023
start = datetime.strptime('01-' + f'{MONTH:02}' + '-' + str(YEAR), '%d-%m-%Y')
end = (start.replace(day=1) + timedelta(days=32)).replace(day=1) - timedelta(days=1)

THOUSANDS = 0
for i in range((end - start).days + 1):
    for i,v in enumerate(CONSUMO_DAY):
        CONSUMO_DAY[i] += THOUSANDS
    CONSUMO.extend(CONSUMO_DAY)
    THOUSANDS += 1000

HOUR = 0
day_timestamp = start
for i,v in enumerate(CONSUMO):
    timestamp = time.mktime((datetime.combine(day_timestamp, datetime.min.time())
                             + timedelta(hours=HOUR + 1)).timetuple())
    line = [CONSUMO[i], datetime.fromtimestamp(timestamp), timestamp]
    CSV_DATA.append(line)
    if HOUR == 23:
        HOUR = 0
        day_timestamp = day_timestamp + timedelta(days=1)
    else:
        HOUR = HOUR + 1

FILENAME = 'consumo_luz_' + str(YEAR) + '_' + f'{MONTH:02}' + '.csv'
with open(FILENAME, mode='w', encoding='utf-8', newline='') as f:
    writer = csv.writer(f)
    writer.writerows(CSV_DATA)
